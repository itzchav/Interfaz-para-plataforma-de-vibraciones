function [DatX1,Datx1,f,P1]= facelerometro(val,tiempo)

%DatX = readmatrix('May_4_2.csv');
%val=DatX ;
val1(1)=val(1);
% for i=1:((length(val)/2)-1)
%     
%     val1(i)=val(2*i+1);
% end

% 
for i=1:(length(val)/2)
    val1(i)=val(2*i);
end
DatX1=val1;
i=1:length(DatX1);
% figure(2);
% subplot(3,1,1);
% plot(i,DatX1(1,:));
% title('Acelerometro'); 

 N = DatX1/max(DatX1);
%valY = sum(N);
%n = length(N);
%%%%Eliminacion del Offset
%valProm = valY/n;
varCent = N - 2.6;


%%%%%%%%Filtro

Num =[    0.0010         0   -0.0020         0    0.0010];
Den =[    1.0000   -2.8723    3.9720   -2.7436    0.9125];
%%100
%Num=[    0.0010         0   -0.0020         0    0.0010];
%Den=[     1.0000   -2.8723    3.9720   -2.7436    0.9125];
%%3-5-11-13
% Num = [    0.7146   -1.4293    0.7146];
% Den =[    1.0000   -1.3461    0.5124];
% 
% Num =[    0.0061         0   -0.0123         0    0.0061];
% Den =[    1.0000   -3.1167    4.2023   -2.7708    0.7910];
Num=1.0e-05 *[ 0.2565         0   -0.7694         0    0.7694         0   -0.2565];
Den =[    1.0000   -5.9389   14.7020  -19.4190   14.4337   -5.7241    0.9462];
%%%80
%Num =[    0.0131         0   -0.0262         0    0.0131];
%Den =[    1.0000   -2.7852    3.6035   -2.3332    0.7038];
Datx1=filter(Num,Den,varCent);

% Datx1=filter(Num,Den,Datx1);
%Datx1=bandpass(DatX1,[30 60],320);

%FFT
Fs = 250;                             % Sampling frequency                          
L = 500;                             % Length of signal
Y = abs( fft(Datx1)/L); 
P1 = Y(1:L/4+1);
P1(2:end-1) = 2*P1(2:end-1);
f = Fs*(0:(L/4))/L;
 
 
 
 figure(1);
subplot(3,1,1);
plot(fin3,DatX1);
title('Aclerometro');
subplot(3,1,2);
plot(Datx1);
subplot(3,1,3);
title('Aclerometro Filtrado');
plot(f,P1);
title('FFT Acelerometro'); 


% Num =[0.0041    0.0288    0.0863    0.1438    0.1438    0.0863    0.0288    0.0041];
% Den =[    1.0000   -1.5515    1.8621   -1.2352    0.5969   -0.1757    0.0319   -0.0025];
% Num=[0.0022         0   -0.0109         0    0.0218         0   -0.0218         0    0.0109         0   -0.0022]
% Den=[1.0000   -4.7636   11.9057  -19.6951   23.6997  -21.4584   14.7919   -7.6559    2.8737   -0.7121   0.0937]
% DatX1=normalize(DatX1,'range',[0,1]);
% Datx1=filter(Num,Den, DatX1);
% i=1:length(Datx1);
% 
% subplot(3,1,2); plot(i,Datx1(1,:));
% title('Aclerometro Filtrado');
% 
% %FFT
% Fs = 100;                             % Sampling frequency                          
% L = 500;                             % Length of signal
% Y = abs( fft(Datx1)/L); 
% P1 = Y(1:L/4+1);
% P1(2:end-1) = 2*P1(2:end-1);
% f = Fs*(0:(L/4))/L;
% 
% subplot(3,1,3);  plot(f,P1)
%title('FFT Acelerometro');  



%Num =[ 0.0004         0   -0.0013         0    0.0013         0   -0.0004];
%Den =[    1.0000   -4.3896    9.1173  -11.0271    8.2084   -3.5580    0.7299];
%Num=[ 0.0085         0   -0.0255         0    0.0255         0   -0.0085];
%Den=[1.0000   -4.3574    8.4704   -9.3432    6.1671   -2.3108    0.3878];
%Num =[ 0.0004         0   -0.0013         0    0.0013         0   -0.0004];
%Den =[    1.0000   -4.3896    9.1173  -11.0271    8.2084   -3.5580    0.7299];
% Num =[  0.7961         0   -1.5923         0    0.7961];
% Den =[      1.0000    0.3061   -1.5114   -0.1918    0.6343];
% Num =[       0.3885         0   -1.1654         0    1.1654         0   -0.3885];
% Den =[       1.0000   -0.7939   -0.9656    0.4030    0.6963   -0.1293   -0.1488];
%Num =[           0.0057         0   -0.0286         0    0.0572         0   -0.0572         0    0.0286         0   -0.0057];
%Den =[      1.0000   -5.4448   14.2231  -23.5735   27.5129  -23.5842   14.9952   -6.9755    2.2768   -0.4728    0.0479];
%Num=[  0.0272         0   -0.0815         0    0.0815         0   -0.0272];
%Den=[1.0000   -3.7848    6.4528   -6.3805    3.8789   -1.3681    0.2195];
%Num=[0.100678534509481,-0.877766843740716,3.79274591531022,-10.5667216414266,20.9976237694121,-31.2246322789952,35.5588394498891,-31.2246322789952,20.9976237694121,-10.5667216414266,3.79274591531022,-0.877766843740716,0.100678534509481];
%Den=[1,-5.62867002652892,15.2914021856062,-26.9171027533344,34.5347805839966,-34.0290141645705,26.2628566173538,-15.9308066879698,7.53611535829910,-2.71313800815814,0.705612724819791,-0.119509887763304,0.0101684182772474];
% Num= [ 0.6712         0   -2.0135         0    2.0135         0   -0.6712];
% Den=[ 1.0000   -0.3410   -2.1598    0.4348    1.6780   -0.1537   -0.4504];
% Num=[0.8255         0   -1.6510         0    0.8255];
% Den=[1.0000   -0.0000   -1.6204    0.0000    0.6817];
% Num= [ 0.0110    0.0549    0.1098    0.1098    0.0549    0.0110];
% Den=[ 1.0000   -1.6170    1.5544   -0.7829    0.2231   -0.0263];
% Num=[0.0433         0   -0.0865         0    0.0433];
% Den=[1.0000   -2.3851    2.7852   -1.6758    0.5046];
% Num =[    0.0077         0   -0.0155         0    0.0077];
% Den =[    1.0000   -3.0918    4.1355   -2.7067    0.7673];
% Datx1=filter(Num,Den,varCent);
% Num =[     0.0035         0   -0.0105         0    0.0105         0   -0.0035];
% Den =[    1.0000   -4.7079    9.7626  -11.3453    7.7874   -2.9964    0.5086];
% Num=[  0.0131         0   -0.0262         0    0.0131];
% Den=[  1.0000   -2.7852    3.6035   -2.3332    0.7038];
% Num=[0.0001         0   -0.0005         0    0.0011         0   -0.0011         0    0.0005         0   -0.0001];
% Den=[1.0000   -6.3294   19.9202  -40.0893   56.7150  -58.6638   44.8913  -25.1138    9.8752   -2.4831    0.3108];
% Num=[    0.0053         0   -0.0158         0    0.0158         0   -0.0053];
% Den=[        1.0000   -3.7379    6.9161   -7.6189    5.3158   -2.2059    0.4545];
%%Num =[ 0.0004         0   -0.0013         0    0.0013         0   -0.0004];
%Den =[1.0000   -4.3896    9.1173  -11.0271    8.2084   -3.5580    0.7299];
% Num=[5.94491536170280e-09,0,-4.16144075319196e-08,0,1.24843222595759e-07,0,-2.08072037659598e-07,0,2.08072037659598e-07,0,-1.24843222595759e-07,0,4.16144075319196e-08];
% Den=[1,-10.3244613736863,52.0718176052653,-168.850499088267,391.717102299116,-686.029025092557,933.894373867947,-1003.00114461231,853.786542858550,-573.383494307938,299.313209150480,-117.952300175464,33.2551879363007,-6.02813121757374,0.533814137866259];
% 
% Num=[      0.0104         0   -0.0208         0    0.0104];
% Den=[      1.0000   -2.4047    3.1444   -2.0566    0.7329];
% % Num =[     0.0057         0   -0.0115         0    0.0057];
% Den =[  1.0000   -2.5641    3.4230   -2.2890    0.7975];
% Num= [  0.3158   -1.5791    3.1581   -3.1581    1.5791   -0.3158];
% Den=[1.0000   -2.7643    3.3626   -2.1576    0.7217   -0.0997];


